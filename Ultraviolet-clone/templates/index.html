<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultraviolet Proxy</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåê Ultraviolet</h1>
            <p class="subtitle">Fast, secure web proxy</p>
        </div>
        
        <div class="search-container">
            <form action="/search" method="GET" class="search-form" id="mainSearchForm">
                <input 
                    type="text" 
                    name="url" 
                    placeholder="Enter URL or search term..." 
                    class="search-input"
                    id="searchInput"
                    autocomplete="off"
                    autofocus
                >
                <button type="submit" class="search-button">
                    <span>Go</span>
                </button>
            </form>
            <div class="search-options">
                <label><input type="radio" name="searchEngine" value="direct" checked> Direct URL</label>
                <label><input type="radio" name="searchEngine" value="duckduckgo"> DuckDuckGo</label>
                <label><input type="radio" name="searchEngine" value="google"> Google</label>
                <label><input type="radio" name="searchEngine" value="bing"> Bing</label>
            </div>
        </div>
        
        <div class="quick-links">
            <h3>Quick Links</h3>
            <div class="links-grid">
                <a href="/search?url=https://www.google.com" class="quick-link">
                    <span class="icon">üîç</span>
                    <span>Google</span>
                </a>
                <a href="/search?url=https://www.bing.com" class="quick-link">
                    <span class="icon">üÖ±Ô∏è</span>
                    <span>Bing</span>
                </a>
                <a href="/search?url=https://duckduckgo.com" class="quick-link">
                    <span class="icon">ü¶Ü</span>
                    <span>DuckDuckGo</span>
                </a>
                <a href="/search?url=https://www.youtube.com" class="quick-link">
                    <span class="icon">‚ñ∂Ô∏è</span>
                    <span>YouTube</span>
                </a>
                <a href="/search?url=https://www.wikipedia.org" class="quick-link">
                    <span class="icon">üìö</span>
                    <span>Wikipedia</span>
                </a>
                <a href="/search?url=https://www.reddit.com" class="quick-link">
                    <span class="icon">üì±</span>
                    <span>Reddit</span>
                </a>
                <a href="/search?url=https://www.twitter.com" class="quick-link">
                    <span class="icon">üê¶</span>
                    <span>Twitter</span>
                </a>
                <a href="/search?url=https://www.github.com" class="quick-link">
                    <span class="icon">üíª</span>
                    <span>GitHub</span>
                </a>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-card">
                <h4>üîí Secure</h4>
                <p>All traffic is encrypted and proxied through our servers</p>
            </div>
            <div class="info-card">
                <h4>‚ö° Fast</h4>
                <p>Optimized for speed with minimal latency</p>
            </div>
            <div class="info-card">
                <h4>üí° Tip</h4>
                <p>Use DuckDuckGo for best search experience (no CAPTCHA)</p>
            </div>
        </div>
        
        <footer>
            <p>Ultraviolet Proxy Clone - Python Edition</p>
        </footer>
    </div>
    
    <script>
        // Register Service Worker on the main page
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/static/sw.js', {
                scope: '/'
            }).then(function(registration) {
                console.log('[UV] Service Worker registered with scope:', registration.scope);
            }).catch(function(error) {
                console.error('[UV] Service Worker registration failed:', error);
            });
        }
        
        // Handle search form with engine selection
        document.getElementById('mainSearchForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const input = document.getElementById('searchInput').value.trim();
            const engine = document.querySelector('input[name="searchEngine"]:checked').value;
            
            if (!input) return;
            
            let url;
            
            // Check if input looks like a URL
            const isUrl = input.includes('.') && !input.includes(' ') || 
                          input.startsWith('http://') || 
                          input.startsWith('https://');
            
            if (engine === 'direct' || isUrl) {
                // Direct URL
                url = input.startsWith('http') ? input : 'https://' + input;
            } else if (engine === 'duckduckgo') {
                // Use DuckDuckGo lite for better proxy compatibility
                url = 'https://lite.duckduckgo.com/lite/?q=' + encodeURIComponent(input);
            } else if (engine === 'google') {
                // Use Google's basic HTML version
                url = 'https://www.google.com/search?q=' + encodeURIComponent(input) + '&udm=14';
            } else if (engine === 'bing') {
                url = 'https://www.bing.com/search?q=' + encodeURIComponent(input);
            }
            
            window.location.href = '/search?url=' + encodeURIComponent(url);
        });
    </script>
    <script src="/static/script.js"></script>
</body>
</html>
